<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>Ù…Ø·Ø¹Ù… Ù…Ø­Ù…Ø¯ Ø³ÙˆØ§Ø¯ÙŠ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap');
        body { font-family: 'Tajawal', sans-serif; background-color: #f8f9fa; -webkit-tap-highlight-color: transparent; }
        .glass { background: rgba(255, 255, 255, 0.85); backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px); }
        .active-cat { background: #4f46e5; color: white; transform: scale(1.05); }
    </style>
</head>
<body class="text-slate-900 pb-24">
    <header class="glass sticky top-0 z-50 p-5 border-b border-white flex justify-between items-center shadow-sm">
        <div class="flex items-center gap-3">
            <div class="w-10 h-10 bg-indigo-600 rounded-xl flex items-center justify-center text-xl text-white shadow-lg">ðŸ“‹</div>
            <div>
                <h1 class="font-black text-slate-800 text-sm">Ù…Ø·Ø¹Ù… Ù…Ø­Ù…Ø¯ Ø³ÙˆØ§Ø¯ÙŠ</h1>
                <p id="table-lbl" class="text-[9px] font-bold text-indigo-500 uppercase"></p>
            </div>
        </div>
    </header>

    <div id="cat-nav" class="flex gap-2 overflow-x-auto p-4 sticky top-[72px] z-40 no-scrollbar bg-slate-50/50 backdrop-blur-sm"></div>

    <main id="content" class="p-4 space-y-8 max-w-lg mx-auto"></main>

    <div id="cart-bar" class="fixed bottom-0 left-0 right-0 p-5 transform translate-y-full transition-all duration-500 z-50">
        <button onclick="sendOrder()" class="w-full bg-indigo-600 text-white h-14 rounded-2xl flex items-center justify-between px-6 font-black shadow-xl active:scale-95 transition-all">
            <div class="flex items-center gap-2"><span id="cart-q" class="bg-white/20 px-2 py-0.5 rounded-lg text-xs">0</span><span>Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</span></div>
            <div class="flex items-center gap-1"><span id="cart-t" class="text-lg">0</span><span class="text-[10px] opacity-70">Ø¯.Ø¹</span></div>
        </button>
    </div>

    <script>
        const structure = [{"name":"Ø§Ù„Ù…Ø£ÙƒÙˆÙ„Ø§Øª","types":[{"name":"Ù…Ø§ÙƒÙˆÙ„Ø§Øª Ø´Ø±Ù‚ÙŠØ©","items":[{"name":"ØªÙ…Ù† ÙˆÙ…Ø±Ù‚","variants":[{"label":"Ù…Ø§Ø¹ÙˆÙ† ØªÙ…Ù† ÙˆÙ…Ø±Ù‚","price":5000},{"label":"Ù‚ÙˆØ²ÙŠ Ø¹ Ø§Ù„ØªÙ…Ù†","price":15000}]},{"name":"ÙƒØ¨Ø© Ù…ÙˆØµÙ„ÙŠØ©","variants":[{"label":"ÙƒØ¨ÙŠØ±","price":3000},{"label":"ÙˆØ³Ø·","price":2000},{"label":"ØµØºÙŠØ±","price":1000}]}]},{"name":"Ù…Ø§ÙƒÙˆÙ„Ø§Øª ØºØ±Ø¨ÙŠØ©","items":[{"name":"Ø¨ÙŠØªØ²Ø§","variants":[{"label":"Ø¹Ø§Ø¯ÙŠ","price":5000},{"label":"Ø¯Ø¨Ù„","price":7000}]}]}]},{"name":"Ø§Ù„Ù…Ù‚Ø¨Ù„Ø§Øª","types":[{"name":"Ø­Ù…Øµ Ø¨ØµØ­ÙŠÙ†Ø©","items":[{"name":"Ø·Ø¨Ù‚ ØµØºÙŠØ±","variants":[{"label":"Ù…Ø¹ ÙƒØµ Ù„Ø­Ù…","price":2000},{"label":"Ø¨Ø¯ÙˆÙ†","price":1000}]}]}]}];
        const phone = "9647711411064";
        const cafeName = "Ù…Ø·Ø¹Ù… Ù…Ø­Ù…Ø¯ Ø³ÙˆØ§Ø¯ÙŠ";
        let cart = [];
        const tableNum = new URLSearchParams(window.location.search).get('table') || "";

        function init() {
            if(tableNum) document.getElementById('table-lbl').innerText = "ðŸ“ Ø§Ù„Ø·Ø§ÙˆÙ„Ø©: " + tableNum;
            renderNav();
            showCategory(0);
        }

        function renderNav() {
            document.getElementById('cat-nav').innerHTML = structure.map((c, i) => `
                <button onclick="showCategory(${i})" id="btn-cat-${i}" class="px-5 py-2.5 rounded-xl font-bold whitespace-nowrap transition-all shadow-sm bg-white text-slate-400">${c.name}</button>
            `).join('');
        }

        function showCategory(index) {
            document.querySelectorAll('[id^="btn-cat-"]').forEach(b => b.classList.remove('active-cat', 'shadow-indigo-100'));
            document.getElementById('btn-cat-'+index).classList.add('active-cat', 'shadow-indigo-100');
            
            const cat = structure[index];
            document.getElementById('content').innerHTML = cat.types.map(type => `
                <section>
                    <h2 class="text-sm font-black text-indigo-600 mb-4 flex items-center gap-2">
                        <span class="w-1 h-4 bg-indigo-500 rounded-full"></span> ${type.name}
                    </h2>
                    <div class="grid gap-3">
                        ${type.items.map(item => `
                            <div class="bg-white p-4 rounded-2xl shadow-sm border border-slate-100">
                                <h3 class="font-bold text-slate-800 text-sm mb-3">${item.name}</h3>
                                <div class="space-y-2">
                                    ${item.variants.map(v => `
                                        <div class="flex justify-between items-center bg-slate-50 p-2 rounded-xl">
                                            <span class="text-[10px] font-bold text-slate-500">${v.label} <span class="mx-1 text-slate-300">|</span> ${v.price.toLocaleString()} Ø¯.Ø¹</span>
                                            <div class="flex items-center gap-3">
                                                ${getQty(item.name, v.label) > 0 ? `
                                                    <button onclick="updateCart('${item.name}','${v.label}',${v.price},-1)" class="w-7 h-7 bg-white rounded-lg shadow-sm border text-slate-400 font-bold">-</button>
                                                    <span class="text-xs font-black text-indigo-600">${getQty(item.name, v.label)}</span>
                                                ` : ''}
                                                <button onclick="updateCart('${item.name}','${v.label}',${v.price},1)" class="w-7 h-7 bg-indigo-600 text-white rounded-lg shadow-md font-bold">+</button>
                                            </div>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </section>
            `).join('');
            window.scrollTo(0,0);
        }

        function updateCart(name, label, price, d) {
            const idx = cart.findIndex(c => c.name === name && c.label === label);
            if(idx > -1) {
                cart[idx].qty += d;
                if(cart[idx].qty <= 0) cart.splice(idx, 1);
            } else if(d > 0) {
                cart.push({name, label, price, qty: 1});
            }
            showCategory(structure.findIndex(c => c.types.some(t => t.items.some(i => i.name === name))));
            updateCartUI();
        }

        function getQty(name, label) {
            const found = cart.find(c => c.name === name && c.label === label);
            return found ? found.qty : 0;
        }

        function updateCartUI() {
            const count = cart.reduce((a, b) => a + b.qty, 0);
            const total = cart.reduce((a, b) => a + (b.price * b.qty), 0);
            document.getElementById('cart-bar').style.transform = count > 0 ? 'translateY(0)' : 'translateY(100%)';
            document.getElementById('cart-q').innerText = count;
            document.getElementById('cart-t').innerText = total.toLocaleString();
        }

        function sendOrder() {
            let m = `*Ø·Ù„Ø¨ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø© - ${cafeName}*\n`;
            m += tableNum ? `ðŸ“ Ø±Ù‚Ù… Ø§Ù„Ø·Ø§ÙˆÙ„Ø©: ${tableNum}\n\n` : `ðŸ›µ Ø§Ø³ØªÙ„Ø§Ù… Ø®Ø§Ø±Ø¬ÙŠ\n\n`;
            cart.forEach(c => m += `â€¢ ${c.name} [${c.label}] x${c.qty}\n`);
            m += `\nðŸ’° *Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${cart.reduce((a, b) => a + (b.price * b.qty), 0).toLocaleString()} Ø¯.Ø¹*`;
            window.location.href = `https://wa.me/${phone}?text=${encodeURIComponent(m)}`;
        }

        window.onload = init;
    </script>
</body>
</html>
